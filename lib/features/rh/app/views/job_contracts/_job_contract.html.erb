<% form_for(@job_contract, :url => employee_job_contract_path([@employee,@job_contract]), :html => {:multipart => true}) do |f| %>
  <%= f.error_messages %>
  <%= error_messages_for(:salary)%>

  <% if is_form_view?%>
    <h2>Informations de l'employé</h2>
    <p>
      <label>Civilité :</label>
      <strong><%= @employee.civility.name %></strong>
    </p>
    <p>
      <label>Nom :</label>
      <strong><%= @employee.last_name %></strong>
    </p>
    <p>
      <label>Prénom :</label>
      <strong><%= @employee.first_name %></strong>
    </p>
  <% end %>

  <h2>Informations du contrat de travail</h2>
  
  <p>
    <%= f.label :job_contract_type_id%>
    <%= f.form_or_view(job_contract_type_select(@job_contract),:job_contract_type, :name) %>
  </p>
  <p>
    <%= f.label :start_date%>
    <%= f.form_or_view(f.date_select( :start_date, :start_year => 1950, :order => [:day,:month,:year], :disabled => is_gone?(@job_contract)),:start_date) %>
  </p>
  <p>
    <%= f.label :end_date%>
    <%= f.form_or_view(f.date_select( :end_date, :start_year => 1950, :order => [:day,:month,:year], :disabled => (@job_contract.end_date.nil? or is_gone?(@job_contract) or @job_contract.job_contract_type.limited==false)), :end_date) %> 
  </p>
  <p>
    <%= f.label :employee_state_id%>
    <%= f.form_or_view(f.collection_select( :employee_state_id, EmployeeState.find(:all,:conditions => ["active=?",1]), :id, :name,{} , {:disabled => is_gone?(@job_contract)}), :employee_state, :name)%>
  </p>
  
  <p>
    <%= f.label :salary%>
    <% if is_form_view? %>
      <%= text_field_tag( 'job_contract[salary_attributes][salary]',@job_contract.salaries==[]? "": @job_contract.salaries.last['salary'].to_s,{:size =>8,:maxlength => 10,:class=>"disable-stylesheet-width",:disabled => is_gone?(@job_contract)})%>
      <%= select('job_contract[salary_attributes][type]','value', ["Brut","Net"],{ :selected => "Brut"},{:disabled => is_gone?(@job_contract)})%>
    <% else%>
      <%= display_formatted_salary(@job_contract,@employee)%>
      <%= display_job_contract_edit_link(@job_contract_controller, @employee)%>
    <% end %>
  </p>
  <% if is_gone?(@job_contract)%>
  <div id="employee_departure_form" >
  <% else %>
  <div id="employee_departure_form" style="display:none;">
  <% end %>
    <h2>D&eacute;part de l&apos;employ&eacute;e</h2>
    <p>
      <%= f.label :employee_state_id, "Status :"%>
      <%= employee_state_inactive(@job_contract)%>
    </p>
    <p>
      <%= label :departure, "Date de d&eacute;part"%>
      <%= f.date_select :departure,{ :start_year => 1950, :order => [:day,:month,:year]},{ :disabled => !is_gone?(@job_contract)}%>
    </p>
  </div>
  <!-- Display Documents div -->
  <%= display_documents_and_add_documents_button(@job_contract, @documents, params, @new_document_number, @error) %>
  
  <% if is_form_view? %>
    <%= submit_tag "Modifier" %>
    <%=link_to 'Retour', employee_path(@employee)%>
  <% end%>
<% end %>
