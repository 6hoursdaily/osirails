<% contextual_menu POSSIBLE_ACTIONS do %>
  <% tool_class = @tool.class.to_s.tableize.singularize %>
  <%= send("new_#{tool_class}_tool_event_link", @tool) %>
  <%= send("#{tool_class}_link", @tool) %>
  <%= send("#{tool_class}s_link") %>
<% end %>

<%= render :partial => 'tools/header', :locals => {:tool => @tool}%>

<h1>Liste des &eacute;v&egrave;nements</h1>
<div class="presentation_small events">
  <% if @paginate_events.empty? %>
    <p>Aucun &eacute;v&egrave;nement</p>
  <% else %>
    <table>
      <tr>
        <th></th>
        <th>D&eacute;signation</th>
        <th>Status</th>
        <th>Type</th>
        <th>Date</th>
        <th>Acteur interne</th>
        <th>Actions</th>
      </tr>
      
      <% for event in @paginate_events %>
      <tr>
        <td><%= effectives_image(event, @effectives_events.include?(event)) %></td>
        <td><%= event.name %></td>
        <td><%= get_status_image(event.status) %></td>
        <td><%= get_event_type_text(event.event_type)%></td>
        <td>
          <%= event.start_date.strftime('%A %d %B %Y') %>
          <%= " - #{get_end_date(event)}" unless event.event_type_name == 'incident' %>
        </td>
        <td><%= get_internal_actor(event) %></td>
        <td><%= links_for_tool_event(@tool, event)%></td>
      </tr> 
      <% end %>
      
    </table>
    <%= will_paginate @paginate_events,  :prev_label => " << pr&eacute;c&eacute;dent", :next_label => "suivant >>" %>
  <% end %>
</div>
