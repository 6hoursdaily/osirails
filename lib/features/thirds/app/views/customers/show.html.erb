<h1>Informations concernant le client </h1>

<div class="frame presentation_medium">
  <h2> Informations g&eacute;n&eacute;rales</h2>
  <p>
    <%= label :customer, :name, "Nom :" %>
    <strong><%= @customer.name %></strong>
  </p>
  <p>
    <%= label :customer, :legal_form, "Forme juridique :" %>
    <strong><%= LegalForm.find(@customer.legal_form_id).name %></strong>
  </p>
  <p>
    <%= label :customer, :siret_number, "Num&eacute;ro Siret :" %>
    <strong><%= @customer.siret_number %></strong>
  </p>
  <p>
    <%= label :customer, :activity_sector, "Secteur d'activit&eacute; :" %>
    <strong><%= @customer.activity_sector.name %></strong>
  </p>
  <p>
    <%= label :customer, :activities, "Activit&eacute;s :" %>
    <strong><%= @customer.activities %></strong>
  </p>
  <p>
    <%= label :customer, :note, "Note :" %>
    <strong><%= @customer.note %></strong>
  </p>

  <h2> Informations bancaires</h2>
  <p>
    <%= label :customer, :payment_method, "Moyen de paiement pr&eacute;f&eacute;r&eacute; :" %>
    <strong><%= @customer.payment_method.name%></strong>
  </p>
  <p>
    <%= label :customer, :payment_timit_limit, "D&eacute;lai de paiement pr&eacute;f&eacute;r&eacute; :" %>
    <strong><%= @customer.payment_time_limit.name%></strong>
  </p>

  <% if @establishment_controller.can_list?(current_user) and Establishment.can_list?(current_user) %>
    <% unless @establishments.empty? %>
      <h2><%= "&Eacute;tablissements" %></h2>
      <% for establishment in @establishments %>
      <p>
        <%= establishment.name + '(' +establishment.address.city_name + ')' %>
        <% if @establishment_controller.can_view?(current_user) and Establishment.can_view?(current_user)%>
        <%= link_to "Plus d'infos", customer_establishment_path(@customer, establishment) %>
        <% end %>
        <% if @establishment_controller.can_delete?(current_user) and Establishment.can_view?(current_user)%>
          <%= link_to "Supprimer", [@customer, establishment], :method => :delete, :confirm => 'Etes vous sûr ?'%>
        <% end %>
      </p>
      <% end %>
    <% end %>
  <% end %>


  <% if @contact_controller.can_list?(current_user) and Contact.can_list?(current_user) %>
    <% unless @contacts.empty? %>
      <h2><%= "Contacts" %></h2>
      <% for contact in @contacts %>
          <p>
            <%= contact.first_name + " " + contact.last_name%>
            <% if @contact_controller.can_view?(current_user) and Contact.can_view?(current_user) %>
                <%= link_to "Plus d'infos", customer_contact_path(@customer, contact, :owner_type => "Customer") %>
            <% end %>
            <% if @contact_controller.can_delete?(current_user) and Contact.can_delete?(current_user) %>
                <%= link_to("Supprimer", [@customer,  contact], :method => :delete, :confirm => 'Etes vous sûr ?') %>
            <% end %>
          </p>
      <% end %>
    <% end %>
  <% end %>
  
<% if controller.can_edit?(current_user) and Customer.can_edit?(current_user)%>
  <%= link_to 'Modifier', :action => 'edit' %> 
<% end %>
  <%= link_to 'Retour', :action => 'index' %>
</div>