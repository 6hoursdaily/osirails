<p>
  <%= label :establishment, "Nom de l'etablissement" %>
  <%= establishment.text_field :name %>
</p>
 
<p>
  <%= label :establishment, "Type d'etablissement"%>
  <%= establishment.select(:establishment_type_id, EstablishmentType.find(:all).collect {|a| [ a.wording, a.id]})%>
</p>

<% fields_for :address, establishment_.address do |address|%>
  <p>
    <%= label :address, "Address1" %>
    <%= address.text_field :address1%>
  </p>
  
    <p>
    <%= label :address, "Address2" %>
    <%= address.text_field :address2%>  
    </p>
    
    <%= render :partial => 'addresses/address',  :locals => {:owner_address => establishment_.address}%>

    <%= hidden_field("country", "id", "value" => '')%>
    <%= hidden_field("city", "id", "value" => '')%>
<%end #fields_for%>

<% #[0].getElementsByClassName('selected')[0].getElementsByClassName('city_id')[0].innerHTML)%>
  <%= observe_field "country_name",
        :frequency => 2,
        :url=>{:controller => "", :action=>'country_change'},
        :with => "'country_name='+encodeURIComponent(document.getElementById('country_name').value)+
       '&city_name='+encodeURIComponent(document.getElementById('city_name').value)"
%>


  <%= observe_field "city_names",
        :update => "city_name",
        :frequency => 2,
        :url=>{:action=>'city_change'},
        :with => "'country_name='+encodeURIComponent(document.getElementById('country_name').value)+
       '&city_name='+encodeURIComponent(document.getElementById('city_name').value)"
%>
