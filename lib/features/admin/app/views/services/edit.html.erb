<h1>Configuration des param&egrave;tres de base de l'entreprise</h1>
<%= display_tabulated_menu %>

<% content_for :header do %>
     <%= javascript_include_tag 'shedules' %>
<% end %>

<% form_for(@service) do |service| %>
  
  
  <div class="frame tabulation">
  
    <h1>Modifier un service</h1>
    <h3>Service :</h3>
    <p>
      <%= service.label :name, "Nom :"  %>
      <%= service.text_field :name %>
    </p>

    <p>
      <%= service.label :service_parent_id, "Service parent :" %>
      <%= service.collection_select_with_indentation(:service_parent_id, @services, :id, :name, options = {:prompt => "-- Racine --", :indentation => 15})%>
    </p>
  
    <h3>Horaires du service :</h3>
      
      <fieldset id="fieldset_config">
      <legend>Configurer les horaires</legend>
      <span class="date_days">
        <%=  javascript_tag "document.getElementById('periode1')"%>
        <%= day_select(0) %> au <%= day_select(1) %>
      </span>&nbsp;
      <span id="shedule_text_field" class="alignment">
        <b>Matinée :</b>
        <%=display_shedule_text_field('morning',1)%>
        &nbsp;
        <b>Apr&egrave;s midi :</b>
        <%=display_shedule_text_field('afternoon',5)%>
      </span>
      <span>
        <a href="#" onclick="modify_schedule();">Ajouter</a>
      </span>
      
      </fieldset>
      

    
  <table id="shedules_array">
    <tr>
      <th></th>
      <th colspan="2">Matin</th>
      <th colspan="2">Apr&egrave;s-midi</th>
    </tr>
    <% default_day = Time::DEFAULT_DAYS_ARRAY %>
    <%( params[:schedules].nil? )? ( (@schedules == [] )? days = default_day : days = days_sort(@schedules) ) : ( days = format_param(params[:schedules]) )%>
    <% days.each_with_index do |elmnt,index|%>
      <% unless index==0%>

        <%="<tr id='t_" + elmnt['day'] + "'>" %>
          <%="<td name=" + elmnt['day'] + ">" %><%= elmnt['day']%></td>
          <%="<td name=" + elmnt['day'] + ">" %><%= to_hour(elmnt['morning_start'].to_f) unless elmnt['morning_start'].nil? %></td>
          <%="<td name=" + elmnt['day'] + ">" %><%= to_hour(elmnt['morning_end'].to_f) unless elmnt['morning_end'].nil?%></td>
          <%="<td name=" + elmnt['day'] + ">" %><%= to_hour(elmnt['afternoon_start'].to_f) unless elmnt['afternoon_start'].nil?%></td>
          <%="<td name=" + elmnt['day'] + ">" %><%= to_hour(elmnt['afternoon_end'].to_f) unless elmnt['afternoon_end'].nil?%></td>
        </tr>
      <% end %>
    <% end %>
  </table>
  <%= hidden_field_tag "schedules[0]", ""%>
  <%= hidden_field_tag "schedules[1]",  schedule_to_s(days[1]) %>
  <%= hidden_field_tag "schedules[2]",  schedule_to_s(days[2]) %>
  <%= hidden_field_tag "schedules[3]",  schedule_to_s(days[3]) %>
  <%= hidden_field_tag "schedules[4]",  schedule_to_s(days[4]) %>
  <%= hidden_field_tag "schedules[5]",  schedule_to_s(days[5]) %>
  <%= hidden_field_tag "schedules[6]",  schedule_to_s(days[6]) %>
  <%= hidden_field_tag "schedules[7]",  schedule_to_s(days[7]) %>
</div>
  <p>
    <%= service.submit "Mettre à jour" %> &#124; <%= link_to 'Retour', services_path %>
  </p>

<% end %>
