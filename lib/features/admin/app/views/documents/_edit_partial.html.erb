
<div id = "testpage">
<% document_versions = DocumentVersion.paginate_all_by_document_id(document.id, :page => params[:page].to_i, :per_page => 1)%>
<%= image_tag(url_for(:controller => "documents",:action => "preview_image", :model => document_versions.first.class, :id => document_versions.first.id )) %>

<!-- form  -->
<iframe id="upload_frame" name="upload_frame" style="display: none"></iframe>

<% form_for([document.has_document, document], :html => { :multipart => true, :target => "upload_frame"}) do |d| %>
    <%= d.error_messages %>
    <p>
      <%= d.label :name%>
      <%= d.text_field :name%>
    </p>
    
    <p>
      <%= d.label :description%>
      <%= d.text_field :description%>
    </p>

    <p>
        <%= d.label :tag_list, "Tags"%>
        <%= d.text_field :tag_list%>
    </p>

    <p>
      <%= label :file, :data, "Fichier :"%>
      <%= file_upload%>
    </p>
    
    <%= d.submit("Uploader")%> <%= link_to("download", :controller => "Downloads", :action => "show", 
        :document => ({:id => document_versions.first.id, :type => document_versions.first.class.name} ))%>
  <%end%>
  

<%= will_paginate document_versions, :renderer => 'RemoteLinkRenderer', :remote => {:update => "testpage"}, :prev_label => " << pr&eacute;c&eacute;dent", :params => {:document_id => document.id}, :next_label => "suivant >>" %>
</div>