<h1>Rechercher</h1>

<% content_for :header do %>
     <%= javascript_include_tag 'search' %>
     <%= javascript_include_tag :defaults %> 
<% end %>



<%form_remote_tag :url =>  "searches/update", :update => "search_result"  do%>
<div class="frame presentation_medium">
  <h2>Section</h2>
  <p>
    <!--<input type="hidden" id="choosen_model" value=""/>-->
    
    <!--Small hack to catch the model name with the controller object -->
    <% choose_model = params[:choosen_model].split("<")[1].split(":")[0].gsub(/Controller/,"").singularize unless params[:choosen_model].nil?%>
    <%= "<input style='display:none;' type='checkbox' id='hidden_model' value='#{choose_model}' />"%>
    <!--observe field for preselected model => advanced search -->
    <%=observe_field("hidden_model", :with => "'model=' + value" ,:url=>{:action=>"model_choose",:line=>0},:href=>(url_for :action=>"model_choose")) %>
    
    <%= model_select(@searches,choose_model)%>
    <%=observe_field("model_select",:on=>"onselect",:with => "'model=' + value" ,:url=>{:action=>"model_choose",:line=>0},:href=>(url_for :action=>"model_choose")) %>
  </p>
  <div id="search_type" style="display:none;">
    <h2>Crit&egrave;res</h2>
    <p>
      respecter 
      <select name="search_type">
        <option value="or">l&apos;un des crit&egrave;res</option>
        <option value="and">tous les crit&egrave;res</option>
        <option value="not">aucun des crit&egrave;res</option>
      </select>
    </p>
  </div>  
  <div id="criteria">
    <div id="criteria_list">
    </div>
  </div>
  <p id="submit_button" style="display:none;">
    <%=submit_tag("rechercher")%>
  <p>
<% end %>
  <div id="search_result">
  </div>
<!-- method call to preselect model if using advanced search-->
<script> loading_function();</script>
</div>
