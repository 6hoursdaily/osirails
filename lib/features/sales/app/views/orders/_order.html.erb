<% content_for :header do -%>
  <%= stylesheet_link_tag_with_theme_support 'core/has_resources/has_resources' %>
  <%= stylesheet_link_tag_with_theme_support 'core/has_contacts/has_contacts' %>
  <%= stylesheet_link_tag_with_theme_support 'sales/sales' %>
  <%= javascript_include_tag 'core/has_contacts/contacts_picker' %>
<% end -%>

<%= display_customer_overview %>

<div class="presentation_medium">
  <h2>Dossier</h2>
  <% form_for order do |form| %>
    <%= form.error_messages %>
  
  <h3>Informations</h3>
  <p>
    <%= form.label :title %>
    <%= form.text_field :title %>
  </p>
  <p>
    <%= form.label :order_type_id %>
    <%= order.new_record? ? form.collection_select(:order_type_id, @order_types, :id, :title) : strong(order.order_type.title) %>
  </p>
  <p>
    <%= form.label :commercial_id %>
    <%= form.collection_select(:commercial_id, @commercials, :id, :fullname, :include_blank => order.new_record?) %>
  </p>

  <h3>Client</h3>
  <p>
    <%= form.label :establishment_id %>
    <%= form.collection_select(:establishment_id, order.customer.establishments, :id, :name_and_full_address, :include_blank => true) %>
    <%= link_to( "(+) Ajouter un Ã©tablissement", new_customer_establishment_path(order.customer) ) %>
  </p>
  
  <h3>Contacts</h3>
  <p>
    <%= form.label :contacts %>
    <%= display_contacts_picker(order, order.customer.contacts) %>
  </p>
  <%= render_new_contacts_list(order) %>
  <%= display_contact_add_button(order) %>
  
  <h3>Dates</h3>
  <% if is_edit_view? %>
    <p>
      <%= form.label :created_at %>
      <%= form.strong order.created_at.to_datetime.humanize  %>
    </p>
  <% end %>
  <p>
    <%= form.label :previsional_delivery %>
    <%= form.date_select :previsional_delivery, :start_year => Date.today.year, :order => [:day, :month, :year], :include_blank => true %>
  </p>
  <p>
    <%= form.label :quotation_deadline %>
    <%= form.date_select :quotation_deadline, :start_year => Date.today.year, :order => [:day, :month, :year], :include_blank => true %>
  </p>
  <p>
    <%= form.hidden_field :customer_id, :value  => order.customer_id %>
    <%= form.reset 'Annuler' %>
    <%= form.submit submit_button_name %>
  </p>
  <% end %>
</div>
