<% empty_line_class = delivery_note_item.quantity > 0 ? '' : ' empty_line' %>

<% fields_for "delivery_note[delivery_note_item_attributes][]", delivery_note_item, :index => nil do |form| %>
  <tr class="delivery_note_item<%= empty_line_class %>">
    <td class="reference"><%= delivery_note_item.reference %></td>
    <td class="designation"><span class="name"><%= delivery_note_item.designation %></span><br/><span class="description"><%= delivery_note_item.description %></span></td>
    <td class="order_quantity"><%= delivery_note_item.order_quantity %></td>
    <td class="ready_to_deliver_quantity"><%= delivery_note_item.ready_to_deliver_quantity %></td>
    <td class="already_delivered_or_scheduled_quantity"><%= delivery_note_item.already_delivered_or_scheduled_quantity %></td>
    <td class="quantity_for_delivery">
      <%= form.form_or_view(form.select(:quantity, (0..delivery_note_item.remaining_quantity_to_deliver),
                                                   {},
                                                   :disabled => delivery_note_item.remaining_quantity_to_deliver.zero?, :onchange => "check_quantity(this.up('.delivery_note_item'))", :class => :input_quantity),
                                        :quantity) %>
      <% unless delivery_note_item.remaining_quantity_to_deliver.zero? %>
        <%= form.hidden_field :id %>
        <%= form.hidden_field :end_product_id %>
        <%= form.hidden_field :order_id %>
      <% end %>
    </td>
  </tr>
<% end %>
